# config/doctrine/schema.yml
---
Persona:
  actAs: {Timestampable: ~}
  columns:
    nombre:           {type: string(50), notnull: true}
    ap_paterno:       {type: string(30), notnull: true}
    ap_materno:       {type: string(30), notnull: true}
    ci:               {type: string(12), notnull: true, unique: true}
    expedido:         {type: string(2), notnull: true}
    direccion:        {type: string(255)}
    telefono:         {type: string(20)}
    celular:          {type: string(20)}
    fax:              {type: string(20)}
    casilla:          {type: string(10)}
    email:            {type: string(255), notnull: false, unique: true}
    fecha_nacimiento: {type: date, notnull: false}
    is_active:        {type: boolean, default: true, notnull: true}
    foto:             {type: string(50), default: null, notnull: false}
  relations:
    sfGuardUser:         {local: id, foreign: persona_id,  type: one, foreignAlias: Persona}
    RepresentanteLegal:  {local: id, foreign: persona_id, type: one, foreignAlias: Persona}
    RegenteFarmaceutico: {local: id, foreign: persona_id, type: one, foreignAlias: Persona}

RepresentanteLegal:
  actAs: {Timestampable: ~}
  columns:
    persona_id: {type: integer, notnull: true}
    is_active:        {type: boolean, default: true, notnull: true}
  relations:
    Persona: {local: persona_id, foreign: id, type: one, foreignAlias: Representante}
    Empresa: {local: id, foreign: representante_legal_id, type: one, foreignAlias: Representante}
    
RegenteFarmaceutico:
  actAs: {Timestampable: ~}
  columns:
    persona_id:            {type: integer, notnull: true}
    matricula_profesional: {type: string(20), notnull: false}
    carnet_colegiado:      {type: string(20), notnull: false}
    is_active:        {type: boolean, default: true, notnull: true}
  relations:
    Persona: {local: persona_id, foreign: id, type: one, foreignAlias: Regente}
    Empresa: {local: id, foreign: regente_farmaceutico_id, type: one, foreignAlias: Regente}
    
Empresa:
  actAs: {Timestampable: ~}
  columns:
    representante_legal_id:  {type: integer, notnull: false}
    regente_farmaceutico_id: {type: integer, notnull: false}
    ciudad_id:               {type: integer, notnull: false}
    razon_social:            {type: string(255), notnull: true, unique: true}
    fecha_registro:          {type: date}
    num_resolucion:          {type: string(30), notnull: false, unique: true}
    fecha_resolucion:        {type: date, notnull: false}
    fax:                     {type: string(20), notnull: false}
    direccion:               {type: string(255)}
    casilla:                 {type: string(20), notnull: false}
    telefono1:               {type: string(20), notnull: true}
    telefono2:               {type: string(20), notnull: false}
    email:                   {type: string(255), notnull: false, unique: true}
    actividad:               {type: string(255), notnull: true}
    registro_camara:         {type: string(30), notnull: false}
    fundempresa:             {type: string(30), notnull: true}
    nit:                     {type: string(30), notnull: true, unique: true}
    licencia_funcionamiento: {type: string(30), notnull: true, unique: true}
    is_active:               {type: boolean, default: true, notnull: true}
  relations:
    RepresentanteLegal:  {local: representante_legal_id, foreign: id, type: one, foreignAlias: Empresa}
    RegenteFarmaceutico: {local: regente_farmaceutico_id, foreign: id, type: one, foreignAlias: Empresa}
    Medicamento:         {local: id, foreign: empresa_id, type: many, foreignAlias: Empresa}
    DispositivoMedico:   {local: id, foreign: empresa_id, type: many, foreignAlias: Empresa}
    Cosmetico:           {local: id, foreign: empresa_id, type: many, foreignAlias: Empresa}
    Higiene:           {local: id, foreign: empresa_id, type: many, foreignAlias: Empresa}
    Ciudad:              {local: ciudad_id, foreign: id, type: one, foreignAlias: Empresa}
    
LaboratorioFabricante:
  actAs: {Timestampable: ~}
  columns:
    pais_id:       {type: integer, notnull: true}
    ciudad_id:     {type: integer, notnull: false}
    nombre:        {type: string(255), notnull: true, unique: true}
    bajo_licencia: {type: string(255), notnull: false}
    para:          {type: string(255), notnull: false}
    direccion:     {type: string(255)}
    telefono:      {type: string(150), notnull: false}
    fax:           {type: string(150), notnull: false}
    email:         {type: string(255), notnull: false, unique: true}
    observaciones: {type: string(2000)}
  relations:
    Pais:             {local: pais_id, foreign: id, type: one, foreignAlias: Laboratorio}
    Medicamento:        {local: id, foreign: laboratorio_fabricante_id, type: many, foreignAlias: Laboratorio}
    DispositivoMedico:  {local: id, foreign: laboratorio_fabricante_id, type: many, foreignAlias: Laboratorio}
    Cosmetico:          {local: id, foreign: laboratorio_fabricante_id, type: many, foreignAlias: Laboratorio}
    Higiene:            {local: id, foreign: laboratorio_fabricante_id, type: many, foreignAlias: Laboratorio}
    Ciudad:       {local: ciudad_id, foreign: id, type: one, foreignAlias: Laboratorio}
    
Pais:
  actAs: {Timestampable: ~}
  columns:
    nombre:    {type: string(150)}
    bandera:   {type: string(50)}
  relations:
    LaboratorioFabricante: {local: id, foreign: pais_id, type: one, foreignAlias: Pais}
    Ciudad:                {local: id, foreign: pais_id, type: one, foreignAlias: Pais}
    Cosmetico:             {local: id, foreign: pais_id, type: one, foreignAlias: Pais}

Ciudad:
  actAs: {Timestampable: ~}
  columns:
    pais_id: {type: integer, notnull: false}
    nombre:  {type: string(150)}
  relations:
    Pais:                  {local: pais_id, foreign: id, type: many, foreignAlias: Ciudades}
    Empresa:               {local: id, foreign: ciudad_id, type: one, foreignAlias: Ciudad}
    LaboratorioFabricante: {local: id, foreign: ciudad_id, type: one, foreignAlias: Ciudad}
#-----------------------------
# Medicamento y su Formulario
Medicamento:
  actAs: {Timestampable: ~}
  columns:
    empresa_id:                {type: integer, notnull: true}
    laboratorio_fabricante_id: {type: integer, notnull: true}
    forma_farmaceutica_id:     {type: integer, notnull: true}
    via_administracion_id:     {type: integer, notnull: true}
    tipo_venta_id:             {type: integer, notnull: true}    
    formula_cc_id:             {type: integer, notnull: false}
    nombre_comercial:          {type: string(255), notnull: true}
    nombre_generico:           {type: string(255), notnull: true}
    concentracion:             {type: string(150), notnull: true}
    accion_terapeutica:        {type: string(2000)}
    conservacion:              {type: string(255)}
    periodo_validez:           {type: string(50)}
    especificacion_envase:     {type: string(2000)}
    envase_clinico:            {type: string(2000)}
    aval:                      {type: string(255)}
    registro_sanitario:        {type: string(50), unique: false, default: NULL}
    certificado_control:       {type: string(30)}
    descripcion:               {type: string(2000), notnull: false}
  relations:
    Formulario5:            {local: id, foreign: medicamento_id, type: many, foreignAlias: Medicamentos}
    Empresa:                {local: empresa_id, foreign: id, type: one, foreignAlias: Medicamentos}
    LaboratorioFabricante:  {local: laboratorio_fabricante_id, foreign: id, type: one, foreignAlias: Medicamentos}
    FormaFarmaceutica:      {local: forma_farmaceutica_id, foreign: id, type: one, foreignAlias: Medicamentos}
    ViaAdministracion:      {local: via_administracion_id, foreign: id, type: one, foreignAlias: Medicamentos}
    TipoVenta:              {local: tipo_venta_id, foreign: id, type: one, foreignAlias: Medicamentos}
    FormulaCc:              {local: formula_cc_id, foreign: id, type: one, foreignAlias: Medicamentos}
#    debria ser many aca arriba
    
FormaFarmaceutica:
  actAs: {Timestampable: ~}
  columns:
    nombre: {type: string(255), notnull: true}
  relations:
    Medicamento: {local: id, foreign: forma_farmaceutica_id, type: many, foreignAlias: Forma}
    
ViaAdministracion:
  actAs: {Timestampable: ~}
  columns:
    nombre: {type: string(100), notnull: true}
  relations:
    Medicamento: {local: id, foreign: via_administracion_id, type: many, foreignAlias: Administracion}
    
TipoVenta:
  actAs: {Timestampable: ~}
  columns:
    nombre: {type: string(100), notnull: true}
  relations:
    Medicamento: {local: id, foreign: tipo_venta_id, type: many, foreignAlias: TipoVenta}
    
FormulaCc:
  actAs: {Timestampable: ~}
  columns:
    observaciones: {type: string(2000), notnull: false}
  relations:
    DetalleFormulaCc: {local: id, foreign: formula_cc_id, type: many, foreignAlias: FormulaCc}
    Medicamento:      {local: id, foreign: formula_cc_id, type: many, foreignAlias: FormulaCc}
DetalleFormulaCc:
  actAs: {Timestampable: ~}
  columns:
    formula_cc_id:  {type: integer, notnull: true}
    ingrediente_id: {type: integer, notnull: false}
    cantidad:       {type: decimal(5), scale: 2, notnull: true}
    unidad:         {type: string(20), notnull: true}
  relations:
    FormulaCc:   {local: formula_cc_id, foreign: id, type: one, foreignAlias: Detalles}
    Ingrediente: {local: ingrediente_id, foreign: id, type: many, foreignAlias: Detalles}
    
Ingrediente:
  actAs: {Timestampable: ~}
  columns:
    nombre: {type: string(100), notnull: true}
  relations:
    DetalleFormulaCc: {local: id, foreign: ingrediente_id, type: one, foreignAlias: Ingrediente}

Formulario5:
  actAs: {Timestampable: ~}
  columns:
    fecha:                        {type: date, notnull: false}
    vigencia:                     {type: integer(2), notnull: false}
    fecha_inicio_vigencia:        {type: date, notnull: false}
    numero_ruta:                  {type: integer, notnull: false}
    tipo_tramite_formulario5_id:  {type: integer, notnull: true}
    tipo_producto_formulario5_id: {type: integer, notnull: true}
    origen_formulario_id:         {type: integer, notnull: true}
    medicamento_id:               {type: integer, notnull: true}
  relations:
    Medicamento:             {local: medicamento_id, foreign: id, type: one, foreignAlias: Formularios5}
    TipoTramiteFormulario5:  {local: tipo_tramite_formulario5_id, foreign: id, type: one, foreignAlias: Formulario5}
    TipoProductoFormulario5: {local: tipo_producto_formulario5_id, foreign: id, type: one, foreignAlias: Formulario5}
    OrigenFormulario:        {local: origen_formulario_id, foreign: id, type: one, foreignAlias: Formulario5}
    Etapa:                   {local: etapa_id, foreign: formulario5_id, type: many, foreignAlias: Formulario5}
    
TipoTramiteFormulario5:
  actAs: {Timestampable: ~}
  columns:
    nombre:      {type: string(30), notnull: true}
  relations:
    Formulario5: {local: id, foreign: tipo_tramite_formulario5_id, type: one, foreignAlias: TipoTramite}

TipoProductoFormulario5:
  actAs: {Timestampable: ~}
  columns:
    nombre:      {type: string(30), notnull: true}
  relations:
    Formulario5: {local: id, foreign: tipo_producto_formulario5_id, type: one, foreignAlias: TipoProducto}

OrigenFormulario:
  actAs: {Timestampable: ~}
  columns:
    nombre:      {type: string(30), notnull: true}
  relations:
    Formulario5:   {local: id, foreign: origen_formulario_id, type: one, foreignAlias: Origen}
    Formulario27:  {local: id, foreign: origen_formulario_id, type: one, foreignAlias: Origen}




#-----------------------------------------
# Dispositivo Medico y su Formulario
DispositivoMedico:
  actAs: {Timestampable: ~}
  columns:
    empresa_id:                {type: integer, notnull: true}
    laboratorio_fabricante_id: {type: integer, notnull: true}
    nombre_comercial:          {type: string(255), notnull: true}
    nombre_generico:           {type: string(255), notnull: true}
    clasificacion_riesgo:      {type: string(1000), notnull: false}
    codigo_internacional:      {type: string(255), notnull: false}
    manual:                    {type: boolean, notnull: false, default: false}
    indicaciones:              {type: string(2000), notnull: false}
    presentacion:              {type: string(2000), notnull: false}
    condicion_empaque:         {type: string(2000), notnull: false}
    vida_util:                 {type: string(2000), notnull: false}
    metodo_desecho:            {type: string(2000), notnull: false}
    registro_sanitario:        {type: string(50), unique: false, default: NULL}
    descripcion:               {type: string(2000), notnull: false}
  relations:
    Formulario27:           {local: id, foreign: dispositivo_medico_id, type: many, foreignAlias: Dispositivos}
    Empresa:                {local: empresa_id, foreign: id, type: one, foreignAlias: Dispositivos}
    LaboratorioFabricante:  {local: laboratorio_fabricante_id, foreign: id, type: one, foreignAlias: Dispositivos}

Formulario27:
  actAs: {Timestampable: ~}
  columns:
    fecha:                          {type: date}
    vigencia:                       {type: integer(2), notnull: false}
    fecha_inicio_vigencia:          {type: date, notnull: false}
    numero_ruta:                    {type: integer, notnull: false}
    tipo_tramite_formulario27_id:   {type: integer, notnull: true}
    origen_formulario_id:           {type: integer, notnull: true}
    datos_formulario27_id:          {type: integer, notnull: true}
    dispositivo_medico_id:                    {type: integer, notnull: true}
  relations:
    DispositivoMedico:              {local: dispositivo_medico_id, foreign: id, type: one, foreignAlias: Formulario27}
    TipoTramiteFormulario27:        {local: tipo_tramite_formulario27_id, foreign: id, type: one, foreignAlias: Formulario27}
    DatosFormulario27:              {local: datos_formulario27_id, foreign: id, type: one, foreignAlias: Formulario27}
    OrigenFormulario:               {local: origen_formulario_id, foreign: id, type: one, foreignAlias: Formulario27}
    Etapa:                          {local: id, foreign: formulario27_id, type: many, foreignAlias: Formulario27}
    
TipoTramiteFormulario27:
  actAs: {Timestampable: ~}
  columns:
    nombre:       {type: string(30), notnull: true}
  relations:
    Formulario27: {local: id, foreign: tipo_tramite_formulario27_id, type: one, foreignAlias: TipoTramite}
    
DatosFormulario27:
  actAs: {Timestampable: ~}
  columns:
    nombre:       {type: string(30), notnull: true}
  relations:
    Formulario27: {local: id, foreign: datos_formulario27_id, type: one, foreignAlias: TipoTramite}

#--------------------------------------------
# Cosmeticos y su formulario

Cosmetico:
  actAs: {Timestampable: ~}
  columns:
    empresa_id:                {type: integer, notnull: true}
    laboratorio_fabricante_id: {type: integer, notnull: true}
    forma_cosmetica_id:        {type: integer, notnull: true}
    grupo_cosmetico_id:        {type: integer, notnull: true}
    marca_id:                  {type: integer, notnull: true}
    pais_id:                   {type: integer, notnull: false}
    nombre:                    {type: string(255), notnull: true}
    codigo_nso:                {type: string(250), notnull: false}
    vigencia_nso:              {type: string(250), notnull: false}
    expediente:                {type: string(250), notnull: false}
    registro_sanitario:        {type: string(50), unique: false, default: NULL}
    descripcion:               {type: string(2000), notnull: false}
  relations:
    Formulario516:           {local: id, foreign: cosmetico_id, type: many, foreignAlias: Cosmeticos}
    Empresa:                {local: empresa_id, foreign: id, type: one, foreignAlias: Cosmeticos}
    LaboratorioFabricante:  {local: laboratorio_fabricante_id, foreign: id, type: one, foreignAlias: Cosmeticos}
    FormaCosmetica:         {local: forma_cosmetica_id, foreign: id, type: one, foreignAlias: Cosmetico}
    GrupoCosmetico:         {local: grupo_cosmetico_id, foreign: id, type: many, foreignAlias: Cosmeticos}
    Marca:                  {local: marca_id, foreign: id, type: many, foreignAlias: Cosmetico}
    Pais:                   {local: pais_id, foreign: id, type: one, foreignAlias: Cosmetico}
    

FormaCosmetica:
  actAs: {Timestampable: ~}
  columns:
    nombre:    {type: string(250), notnull: true}
  relations:
    Cosmetico: {local: id, foreign: forma_cosmetica_id, type: one, foreignAlias: FormaCosmetica}

GrupoCosmetico:
  actAs: {Timestampable: ~}
  columns:
    nombre:    {type: string(250), notnull: true}
  relations:
    Cosmetico: {local: id, foreign: grupo_cosmetico_id, type: one, foreignAlias: GrupoCosmetico}
    
Marca:
  actAs: {Timestampable: ~}
  columns:
    nombre:    {type: string(250), notnull: true}
  relations:
    Cosmetico: {local: id, foreign: marca_id, type: one, foreignAlias: Marca}
    
Formulario516:
  actAs: {Timestampable: ~}
  columns:
    fecha:                          {type: date}
    cosmetico_id:                   {type: integer, notnull: true}
    vigencia:                       {type: integer(2), notnull: false}
    fecha_inicio_vigencia:          {type: date, notnull: false}
    numero_ruta:                    {type: integer, notnull: false}
    tipo_tramite_formulario_id:     {type: integer, notnull: true}
    datos:                          {type: string(150), notnull: true}
    datos_titular:                  {type: string(150), notnull: true}
    maquila_embasador:              {type: string(255), notnull: false}
    maquila_empacador:              {type: string(255), notnull: false}
    maquila_acondicionador:         {type: string(255), notnull: false}
    maquila_fabricado_para:         {type: string(255), notnull: false}
    #falta por definir los anexos
  relations:
    Cosmetico:                      {local: cosmetico_id, foreign: id, type: one, foreignAlias: Formulario516}
    TipoTramiteFormulario:          {local: tipo_tramite_formulario_id, foreign: id, type: one, foreignAlias: Formulario516}
    Etapa:                          {local: id, foreign: formulario516_id, type: many, foreignAlias: Formulario516}

TipoTramiteFormulario:
  actAs: {Timestampable: ~}
  columns:
    nombre:        {type: string(100), notnull: true}
  relations:
    Formulario516: {local: id, foreign: tipo_tramite_formulario_id, type: one, foreignAlias: TipoTramite}

#--------------------------------------------
# Higiene y su formulario

Higiene:
  actAs: {Timestampable: ~}
  columns:
    empresa_id:                {type: integer, notnull: true}
    laboratorio_fabricante_id: {type: integer, notnull: true}
    grupo_higiene:             {type: string(255), notnull: true}
    marca_id:                  {type: integer, notnull: true}
    pais_id:                   {type: integer, notnull: false}
    nombre:                    {type: string(255), notnull: true}
    phd:                       {type: boolean, notnull: false, default: false}
    pahp:                      {type: boolean, notnull: false, default: false}
    variedad:                  {type: string(2000), notnull: false}
    codigo_nso:                {type: string(250), notnull: false}
    vigencia_nso:              {type: string(250), notnull: false}
    expediente:                {type: string(250), notnull: false}
  relations:
    Formulario706:             {local: id, foreign: higiene_id, type: many, foreignAlias: Higienes}
    Empresa:                   {local: empresa_id, foreign: id, type: one, foreignAlias: Higienes}
    LaboratorioFabricante:     {local: laboratorio_fabricante_id, foreign: id, type: one, foreignAlias: Higienes}
    Marca:                     {local: marca_id, foreign: id, type: one, foreignAlias: Higiene}
    Pais:                      {local: pais_id, foreign: id, type: one, foreignAlias: Higiene}

Formulario706:
  actAs: {Timestampable: ~}
  columns:
    fecha:                      {type: date}
    higiene_id:                 {type: integer, notnull: true}
    vigencia:                   {type: integer(2), notnull: false}
    fecha_inicio_vigencia:      {type: date, notnull: false}
    numero_ruta:                {type: integer, notnull: false}
    tipo_tramite_formulario_id: {type: integer, notnull: true}
    datos:                      {type: string(150), notnull: true}
    datos_titular:              {type: string(150), notnull: true}
    maquila_embasador:          {type: string(255), notnull: false}
    maquila_empacador:          {type: string(255), notnull: false}
    maquila_acondicionador:     {type: string(255), notnull: false}
    maquila_fabricado_para:     {type: string(255), notnull: false}
    #falta por definir los a 
  relations:
    Higiene:                    {local: higiene_id, foreign: id, type: one, foreignAlias: Formulario706}
    TipoTramiteFormulario:      {local: tipo_tramite_formulario_id, foreign: id, type: one, foreignAlias: Formulario706}
    Etapa:                      {local: id, foreign: formulario706_id, type: many, foreignAlias: Formulario706}

#--------------------------------------------

Etapa:
  actAs: {Timestampable: ~}
  columns:
    formulario5_id:   {type: integer, notnull: false}
    formulario27_id:  {type: integer, notnull: false}
    formulario516_id: {type: integer, notnull: false}
    formulario706_id: {type: integer, notnull: false}
    tipo_etapa_id:    {type: integer, notnull: true}
    fecha:            {type: date, notnull: true}
    observacion:      {type: string(2000), notnull: false}
  relations:
    TipoEtapa:     {local: tipo_etapa_id, foreign: id, type: one, foreignAlias: Etapa}
    Formulario5:   {local: formulario5_id, foreign: id, type: one, foreignAlias: Etapas}
    Formulario27:  {local: formulario27_id, foreign: id, type: one, foreignAlias: Etapas}
    Formulario516: {local: formulario516_id, foreign: id, type: one, foreignAlias: Etapas}
    Formulario706: {local: formulario706_id, foreign: id, type: one, foreignAlias: Etapas}
    
TipoEtapa:
  actAs: {Timestampable: ~}
  columns:
    nombre:      {type: string(250), notnull: true}
    descripcion: {type: string(2000), notnull: false}
  relations:
    Etapa: {local: id, foreign: tipo_etapa_id, type: one, foreignAlias: Tipo}

